>>== MODE ==>>
citation
<<== MODE ==<<

>>===== CITATION-ITEMS =====>>
[
    [
        {
            "id": "ITEM-1"
        }, 
        {
            "id": "ITEM-2"
        }
    ]
]
<<===== CITATION-ITEMS =====<<

The result string is a mess, but it confirms that things are working.

(1) The two cites should collapse by omitting the author and title from the second cite; and
(2) The "translation" should be omitted on the second cite.
(3) Italics should be suppressed on the non-romaneque title.

NOTE: This test has been rolled back to doing transliteration only on
the container-title variable. The more demanding test case described
above (with orig as main, and translit as variant) is not represented
here because of limitations in the test suite (and lack of time and
incentive to fix it). The test did run as described before the
reversion though, like this:

林秀弥, 競争法における関連市場の画定基準, 126 <span style="font-variant:small-caps;">民商法雑誌</span> <span style="font-variant:small-caps;">Minsho ho zasshi</span>, no. 1, at 23, 126 <span style="font-variant:small-caps;">民商法雑誌</span>, no. 2, 2002, at 56.



>>== RESULT ==>>
林秀弥, 競争法における関連市場の画定基準, 126 <span style="font-variant:small-caps;">Minsho ho zasshi</span>, no. 1, at 23, 126 <span style="font-variant:small-caps;">Minsho ho zasshi</span>, no. 2, 2002, at 56.
<<== RESULT ==<<

>>===== CSL =====>>
<style xmlns="http://purl.org/net/xbiblio/csl" class="note" page-range-format="chicago" version="1.1mlz1" year-range-format="expanded" default-locale="ja-JP-x-translit-ja-alalc97">
  <info>
    <title>Test fixture</title>
    <id>http://citationstyles.org/tests/fixture</id>
    <link href="http://citationstyles.org/tests/fixture" rel="self"/>
    <link href="http://citationstyles.org/documentation/text" rel="documentation"/>
    <category citation-format="author-date"/>
    <updated>2014-04-30T13:19:38+00:00</updated>
    <rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights>
  </info>
  <locale>
    <style-options skip-words="but or yet so for and nor a an the at by from in into of on to with up down as via onto over till is this that within"/>
    <terms>
      <term name="article">article</term>
      <term name="director">director</term>
      <term form="short" name="director">dir.</term>
      <term form="short" name="article">
        <single>art.</single>
        <multiple>arts.</multiple>
      </term>
      <term form="long" name="Section">
        <single>section</single>
        <multiple>sections</multiple>
      </term>
      <term form="short" name="Section">
        <single>sec.</single>
        <multiple>secs.</multiple>
      </term>
      <term form="long" name="Chapter">
        <single>chapter</single>
        <multiple>chapters</multiple>
      </term>
      <term form="short" name="Chapter">
        <single>ch.</single>
        <multiple>chs.</multiple>
      </term>
      <term form="symbol" name="Chapter">
        <single>c.</single>
        <multiple>cc.</multiple>
      </term>
      <term name="rule"/>
      <term name="title">title</term>
      <term form="short" name="title">tit.</term>
      <term form="short" name="chapter">ch.</term>
      <term form="short" name="column">col.</term>
      <term form="short" name="figure">fig.</term>
      <term form="short" name="issue">no.</term>
      <term form="short" name="line">
        <single>l.</single>
        <multiple>ll.</multiple>
      </term>
      <term form="short" name="note">
        <single>n.</single>
        <multiple>nn.</multiple>
      </term>
      <term form="short" name="opus">op.</term>
      <term form="short" name="page">
        <single>p.</single>
        <multiple>pp.</multiple>
      </term>
      <term form="short" name="paragraph">
        <single>para.</single>
        <multiple>paras.</multiple>
      </term>
      <term form="short" name="part">pt.</term>
      <term form="short" name="section">
        <single>sec.</single>
        <multiple>secs.</multiple>
      </term>
      <term form="symbol" name="section">
        <single>&#167;</single>
        <multiple>&#167;&#167;</multiple>
      </term>
      <term form="short" name="sub verbo">s.v.</term>
      <term form="short" name="verse">vrs.</term>
      <term form="short" name="volume">vol.</term>
      <term form="short" name="edition">
        <single>ed.</single>
        <multiple>eds.</multiple>
      </term>
      <term form="short" name="supplement">
        <single>supp.</single>
        <multiple>supps.</multiple>
      </term>
      <term name="ibid">id.</term>
      <term form="verb" name="interview">interview</term>
      <term form="short" name="translator">trans.</term>
      
      <term name="ordinal-01">st</term>
      <term name="ordinal-02">d</term>
      <term name="ordinal-03">d</term>
      <term name="ordinal-04">th</term>
    </terms>
    <date form="text">
      <date-part form="short" name="month" suffix=" "/>
      <date-part form="numeric" name="day" suffix=", "/>
      <date-part name="year"/>
    </date>
  </locale>
  <macro name="std-authority-key">
    <names variable="authority">
      <name/>
      <institution form="short"/>
    </names>
  </macro>
  <macro name="std-authority-full">
    <group delimiter=" ">
      <choose>
        <if subjurisdictions="2">
          <text macro="std-authority-child"/>
          <text form="short" variable="jurisdiction"/>
        </if>
        <else>
          <text form="short" variable="jurisdiction"/>
          <text macro="std-authority-child"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="std-authority-child">
    <names variable="authority">
      <name/>
      <institution institution-parts="short" use-first="1"/>
    </names>
  </macro>
  <macro name="std-locator-label">
    <group delimiter=" ">
      <label form="short" variable="locator"/>
      <number variable="locator"/>
    </group>
  </macro>
  <macro name="std-locator-paragraph-bracket-at">
    <group delimiter=" ">
      <choose>
        <if locator="page paragraph" match="none">
          <label form="short" variable="locator"/>
        </if>
        <else-if locator="page paragraph">
          <text term="at"/>
        </else-if>
      </choose>
      <choose>
        <if locator="paragraph">
          <number prefix="[" suffix="]" variable="locator"/>
        </if>
        <else>
          <number variable="locator"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="std-locator-paragraph-bracket">
    <group delimiter=" ">
      <choose>
        <if locator="page paragraph" match="none">
          <label form="short" variable="locator"/>
        </if>
      </choose>
      <choose>
        <if locator="paragraph">
          <number prefix="[" suffix="]" variable="locator"/>
        </if>
        <else>
          <number variable="locator"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="nz-legislation-first">
    <group delimiter=" ">
      <text form="short" variable="title"/>
      <group delimiter=", ">
        <group delimiter=" ">
          <date date-parts="year" form="text" variable="issued"/>
          <group delimiter=" " prefix="(" suffix=")">
            <choose>
              <if jurisdiction="gb" match="none">
                <text form="short" variable="jurisdiction"/>
              </if>
            </choose>
            <number variable="collection-number"/>
            <text form="short" variable="genre"/>
            <number label-form="symbol" variable="number"/>
          </group>
        </group>
        <text label-form="symbol" macro="std-locator-label"/>
      </group>
    </group>
  </macro>

  <macro name="std-patent-detail">
    <group delimiter=", ">
      <text variable="title"/>
      <group delimiter=" ">
        <text form="short" variable="jurisdiction"/>
        <choose>
          <if variable="genre">
            <text variable="genre"/>
            <text value="no."/>
          </if>
          <else>
            <text value="Patent No."/>
          </else>
        </choose>
        <number variable="number"/>
      </group>
    </group>
  </macro>
  <macro name="std-inventor-label">
    <choose>
      <if is-plural="author">
        <text value="inventors"/>
      </if>
      <else>
        <text value="inventor"/>
      </else>
    </choose>
  </macro>
  <macro name="std-assignee-label">
    <choose>
      <if is-plural="recipient">
        <text value="assignees"/>
      </if>
      <else>
        <text value="assignee"/>
      </else>
    </choose>
  </macro>
  <macro name="std-authority-child-shy">
    <names variable="authority">
      <name/>
      <institution institution-parts="short" stop-last="1" use-first="1"/>
    </names>
  </macro>
  <macro name="std-collection-number">
	<number variable="collection-number"/>
  </macro>
  <macro name="gb-case-first">
    <group delimiter=" ">
      <group delimiter=", ">
        <text form="short" variable="title"/>
        <choose>
          <if match="any" variable="collection-number container-title">
            <group delimiter=" ">
              <text macro="gb-case-reported-detail"/>
              <text macro="oscola-case-hinted-page"/>
            </group>
          </if>
        </choose>
      </group>
      <choose>
        <if match="none" variable="container-title collection-number">
          <text macro="gb-case-unreported-detail"/>
          <text macro="oscola-case-hinted-page"/>
        </if>
      </choose>
    </group>
  </macro>

  <macro name="gb-case-reported-detail">
    <group delimiter=" ">
      <choose>
        <if variable="collection-number">
          <text macro="std-collection-number" prefix="[" suffix="]"/>
        </if>
        <else>
          <choose>
            <if variable="issued">
              <date date-parts="year" form="text" prefix="(" suffix=")" variable="issued"/>
            </if>
            <else>
              <date date-parts="year" form="text" prefix="(" suffix=")" variable="issued"/>
            </else>
          </choose>
        </else>
      </choose>
      <number variable="volume"/>
      <text macro="oscola-container-title"/>
    </group>
  </macro>  

  <macro name="gb-case-unreported-detail">
    <group delimiter=" ">
      <date date-parts="year" form="text" prefix="[" suffix="]" variable="issued"/>
      <group delimiter=" ">
        <text value="Case no"/>
        <number variable="number"/>
      </group>
      <group delimiter=", " prefix="(" suffix=")">
        <text macro="std-authority-full"/>
        <text variable="publisher-place"/>
        <date date-parts="year-month-day" form="text" variable="issued"/>
      </group>
    </group>
  </macro>


  <macro name="gb-case-subsequent">
    <group delimiter=" ">
      <group delimiter=", ">
        <choose>
          <if variable="hereinafter">
            <text font-style="italic" variable="hereinafter"/>
          </if>
          <else>
            <text font-style="italic" form="short" variable="title-short"/>
          </else>
        </choose>
        <choose>
          <if match="any" variable="container-title collection-number">
            <group delimiter=" ">
              <text macro="gb-case-reported-detail"/>
              <choose>
                <if locator="paragraph" match="all" variable="locator">
                  <group delimiter=" ">
                    <number variable="page-first"/>
                    <text macro="std-locator-paragraph-bracket"/>
                  </group>
                </if>
                <else-if match="none" variable="locator">
                  <number variable="page-first"/>
                </else-if>
                <else>
                  <text macro="std-locator-paragraph-bracket"/>
                </else>
              </choose>
            </group>
          </if>
        </choose>
      </group>
      <choose>
        <if match="none" variable="container-title collection-number">
          <text macro="gb-case-unreported-detail"/>
          <text macro="std-locator-paragraph-bracket-at"/>
        </if>
      </choose>
    </group>
  </macro>


  <macro name="oscola-non-paragraph-point-locators">
    <group delimiter=" ">
          <choose>
            <if locator="page" match="none">
              <label form="short" variable="locator"/>
            </if>
          </choose>
          <number variable="locator"/>
    </group>
  </macro>
  <macro name="oscola-editor-translator-context">
    <names variable="editor translator">
      <name/>
      <label form="short" prefix=" (" suffix=")"/>
    </names>
  </macro>
  <macro name="oscola-container-title">
    <choose>
      <if match="any" variable="container-title">
        <text form="short" variable="container-title"/>
      </if>
      <else-if type="legal_case">
        <text macro="std-authority-key"/>
      </else-if>
    </choose>
  </macro>
  <macro name="gb-hearing-first">
    <group delimiter=", ">
      <group delimiter=" ">
        <group delimiter=" ">
          <names variable="author">
            <name/>
            <institution institution-parts="short" use-first="1"/>
            <substitute>
              <text form="short" variable="title"/>
            </substitute>
          </names>
          <text value="Deb"/>
          <text prefix="(" suffix=")" variable="genre"/>
        </group>
        <date date-parts="year-month-day" form="text" variable="issued"/>
      </group>
      <group delimiter=" ">
        <label form="short" variable="volume"/>
        <number variable="volume"/>
      </group>
      <text macro="std-locator-non-page-label"/>
    </group>
  </macro>

  <macro name="gb-hearing-subsequent">
    <group delimiter=", ">
      <group delimiter=" ">
        <group delimiter=" ">
          <names variable="author">
            <name/>
            <institution institution-parts="short" use-first="1"/>
            <substitute>
              <text form="short" variable="title"/>
            </substitute>
          </names>
          <text value="Deb"/>
          <text prefix="(" suffix=")" variable="genre"/>
        </group>
      </group>
      <text macro="wisconsin-supra-stub"/>
    </group>
  </macro>

  <macro name="gb-report-first">
    <group delimiter=" ">
      <group delimiter=", ">
        <names variable="author">
          <name name-as-sort-order="all" sort-separator=" "/>
          <institution use-first="1"/>
          <label form="short" prefix=" (" suffix=")"/>      
          <substitute>
            <text macro="oscola-editor-translator-context"/>
          </substitute>
        </names>
        <group delimiter=" " font-style="italic">
          <text form="short" variable="title"/>
        </group>
      </group>
      <group delimiter=", " prefix="(" suffix=")">
        <text variable="genre"/>
        <choose>
          <if match="all" type="report" variable="collection-title number">
            <group delimiter=" ">
              <text form="short" variable="collection-title"/>
              <number variable="number"/>
            </group>
            <date date-parts="year" form="text" variable="issued"/>
          </if>
          <else-if variable="number">
            <text form="short" variable="publisher"/>
            <number variable="number"/>
            <date date-parts="year" form="text" variable="issued"/>
          </else-if>
          <else>
            <date date-parts="year" form="text" variable="issued"/>
            <group delimiter=" " subgroup-delimiter=", " subgroup-delimiter-precedes-last="always">
              <text variable="publisher"/>
              <text variable="publisher-place"/>
            </group>
          </else>
        </choose>
      </group>
      <text macro="oscola-non-paragraph-point-locators"/>
    </group>
  </macro>
  
  <macro name="gb-report-subsequent">
    <group delimiter=", ">
      <group delimiter=" ">
        <group delimiter=", ">
          <names variable="author">
            <name name-as-sort-order="all" sort-separator=" "/>
            <institution use-first="1"/>
            <label form="short" prefix=" (" suffix=")"/>      
            <substitute>
              <text macro="oscola-editor-translator-context"/>
            </substitute>
          </names>
          <group delimiter=" " font-style="italic">
            <text form="short" variable="title"/>
          </group>
        </group>
      </group>
      <text macro="wisconsin-supra-stub"/>
    </group>
  </macro>
  
  <macro name="us-default-author">
    <group delimiter=" ">
      <choose>
        <if type="interview">
          <choose>
            <if match="all" variable="genre interviewer">
              <text text-case="title" variable="genre"/>
            </if>
            <else>
              <text form="verb" term="interview"/>
            </else>
          </choose>
          <group delimiter=" ">
            <text term="by"/>
            <names variable="interviewer">
              <name/>
            </names>
          </group>
          <text value="with"/>
        </if>
      </choose>
      <choose>
        <if match="any" type="book song">
          <choose>
            <if variable="version">
              <text macro="us-author"/>
            </if>
            <else>
              <text font-variant="small-caps" macro="us-author"/>
            </else>
          </choose>
        </if>
        <else-if match="any" type="chapter">
          <choose>
            <if match="all" variable="author container-author">
              <text macro="us-author"/>
            </if>
            <else>
              <text font-variant="small-caps" macro="us-author"/>
            </else>
          </choose>
        </else-if>
        <else-if type="video">
          <text macro="us-author"/>
        </else-if>
        <else>
          <choose>
            <if type="personal_communication">
              <group delimiter=" ">
                <choose>
                  <if variable="genre">
                    <text text-case="capitalize-first" variable="genre"/>
                  </if>
                  <else>
                    <text term="letter" text-case="capitalize-first"/>
                  </else>
                </choose>
                <group delimiter=" ">
                  <text term="from"/>
                  <names variable="author">
                    <name and="symbol" delimiter-precedes-last="never" initialize="false" initialize-with="."/>
                    <institution institution-parts="short" use-first="1" use-last="1">
                      <institution-part name="short" suffix=","/>
                    </institution>
                  </names>
                </group>
                <group delimiter=" ">
                  <text value="to"/>
                  <names variable="recipient">
                    <name and="symbol" delimiter-precedes-last="never" initialize="false" initialize-with="."/>
                    <institution use-first="1" use-last="1"/>
                  </names>
                </group>
              </group>
            </if>
            <else>
              <text macro="us-author"/>
            </else>
          </choose>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="us-container-author">
    <names variable="container-author">
      <name and="symbol" delimiter-precedes-last="never" initialize="false" initialize-with="."/>
      <institution institution-parts="short" use-first="1" use-last="1"/>
    </names>
  </macro>
  <macro name="us-author">
    <choose>
      <if type="interview">
        <names variable="author">
          <name and="symbol" delimiter-precedes-last="never" initialize="false" initialize-with="."/>
          <institution use-first="1" use-last="1"/>
        </names>
      </if>
      <else-if type="broadcast" match="none">
        <names variable="author">
          <name and="symbol" delimiter-precedes-last="never" form="long" initialize="false" initialize-with="."/>
          <substitute>
            <names variable="container-author"/>
            <names variable="composer"/>
          </substitute>
        </names>
      </else-if>
    </choose>
  </macro>
  <macro name="us-author-short">
    <choose>
      <if match="any" type="book song">
        <choose>
          <if variable="version">
            <names variable="author">
              <name and="symbol" delimiter-precedes-last="never" form="short" initialize-with="."/>
            </names>
          </if>
          <else>
            <names font-variant="small-caps" variable="author">
              <name and="symbol" delimiter-precedes-last="never" form="short" initialize-with="."/>
              <substitute>
                <names variable="composer"/>
                <text macro="us-default-title"/>
              </substitute>
            </names>
          </else>
        </choose>
      </if>
      <else-if type="video">
        <names variable="author">
          <name and="symbol" delimiter-precedes-last="never" form="short" initialize-with="."/>
          <substitute>
            <names variable="composer"/>
            <names variable="editor"/>
          </substitute>
        </names>
      </else-if>
      <else-if type="interview">
        <names variable="author">
          <name and="symbol" delimiter-precedes-last="never" form="short" initialize-with="."/>
          <institution substitute-use-first="1" use-last="0"/>
        </names>
      </else-if>
      <else-if type="broadcast" match="none">
        <names variable="author">
          <name and="symbol" delimiter-precedes-last="never" form="short" initialize-with="."/>
          <substitute>
            <names variable="container-author"/>
            <text macro="us-title-short-format"/>
          </substitute>
        </names>
      </else-if>
    </choose>
  </macro>
  
  <macro name="us-editor">
    <choose>
      <if type="broadcast">
        <group delimiter=" ">
          <names delimiter=", " variable="author">
            <name and="symbol" delimiter-precedes-last="never"/>
          </names>
          <text term="director" form="short"/>
        </group>
      </if>
      <else>
        <names delimiter=", " variable="director editor translator">
          <name and="symbol" delimiter-precedes-last="never"/>
          <label form="short" prefix=" "/>
        </names>
      </else>
    </choose>
  </macro>

  <macro name="us-title-version">
    <group delimiter=", ">
      <choose>
        <if is-numeric="version">
          <group delimiter=" ">
            <text value="ver."/>
            <text variable="version"/>
          </group>
          <text form="short" variable="medium"/>
        </if>
        <else>
          <text quotes="true" variable="version"/>
          <text form="short" variable="medium"/>
        </else>
      </choose>
    </group>
  </macro>

  <macro name="us-default-title">
    <choose>
      <if type="book song motion_picture">
        <choose>
          <if match="all" variable="title version">
            <group delimiter=", ">
              <text form="short" text-case="title" variable="title"/>
              <choose>
                <if disambiguate="true">
                  <text macro="us-title-version"/>
                </if>
                <else-if position="subsequent"/>
                <else>
                  <text macro="us-title-version"/>
                </else>
              </choose>
            </group>
          </if>
          <else-if variable="container-title">
            <group delimiter=" ">
              <text font-style="italic" form="short" text-case="title" variable="title"/>
              <names prefix="[" suffix="]" variable="composer">
                <name form="short" initialize-with="."/>
              </names>
            </group>
          </else-if>
          <else-if match="all" type="song" variable="collection-title">
            <text font-style="italic" form="short" text-case="title" variable="title"/>
          </else-if>
          <else>
            <!-- This needs to be extended to all forms, but will have to wait for better logic -->
            <choose>
              <if position="subsequent" variable="title-short" match="all">
                <text font-variant="small-caps" form="short" text-case="title" variable="title-short"/>
              </if>
              <else>
                <text font-variant="small-caps" form="short" text-case="title" variable="title"/>
              </else>
            </choose>
          </else>
        </choose>
      </if>
      <else-if match="any" type="broadcast video">
        <choose>
          <if match="all" variable="container-title publisher">
            <group delimiter=": " font-style="italic">
              <text form="short" text-case="title" variable="container-title"/>
              <text form="short" text-case="title" variable="title"/>
            </group>
          </if>
          <else-if variable="container-title">
            <text font-style="italic" form="short" variable="title"/>
          </else-if>
          <else-if type="video">
            <text form="short" text-case="title" variable="title"/>
          </else-if>
          <else>
            <text font-variant="small-caps" form="short" text-case="title" variable="title"/>
          </else>
        </choose>
      </else-if>
      <else-if match="any" type="post post-weblog webpage">
        <choose>
          <if variable="container-title">
            <text font-style="italic" form="short" text-case="title" variable="title"/>
          </if>
          <else>
            <text form="short" text-case="title" variable="title"/>
          </else>
        </choose>
      </else-if>
      <else-if match="any" type="paper-conference">
        <choose>
          <if variable="container-title">
            <text font-style="italic" form="short" text-case="title" variable="title"/>
          </if>
          <else>
            <text form="short" text-case="title" variable="title"/>
          </else>
        </choose>
      </else-if>
      <else-if match="any" type="article-magazine graphic article-journal article-newspaper">
        <text font-style="italic" form="short" text-case="title" variable="title"/>
      </else-if>
      <else-if type="entry-encyclopedia entry-dictionary" match="any">
        <choose>
          <if variable="author">
            <text font-style="italic" form="short" text-case="title" variable="title"/>
          </if>
        </choose>
      </else-if>
      <else-if type="chapter" match="any">
        <text font-style="italic" form="short" text-case="title" variable="title"/>
      </else-if>
      <else-if type="personal_communication">
        <text form="short" variable="title"/>
      </else-if>
      <else>
        <text form="short" text-case="title" variable="title"/>
      </else>
    </choose>
  </macro>
  <macro name="us-title-short">
    <choose>
      <if match="none" variable="author composer container-author">
        <text macro="us-title-short-format-select"/>
      </if>
      <else-if type="motion_picture broadcast">
        <text macro="us-title-short-format-select"/>
      </else-if>
      <else-if disambiguate="true">
        <text macro="us-title-short-format-select"/>
      </else-if>
    </choose>
  </macro>
  <macro name="us-title-short-format">
    <choose>
      <if variable="container-title">
        <choose>
          <if type="broadcast">
            <group delimiter=": " font-style="italic">
              <text form="short" text-case="title" variable="container-title"/>
              <text form="short" text-case="title" variable="title"/>
            </group>
          </if>
          <else-if match="all" type="video" variable="publisher">
            <group delimiter=": " font-style="italic">
              <text form="short" text-case="title" variable="container-title"/>
              <text form="short" text-case="title" variable="title"/>
            </group>
          </else-if>
          <else>
            <text font-style="italic" form="short" variable="title"/>
          </else>
        </choose>
      </if>
      <else-if type="book song motion_picture broadcast post post-weblog webpage">
        <choose>
          <if match="all" variable="title version">
            <text form="short" variable="title"/>
          </if>
          <else>
            <text font-variant="small-caps" form="short" variable="title"/>
          </else>
        </choose>
      </else-if>
      <else-if type="article-magazine graphic article-journal article-newspaper">
        <text font-style="italic" form="short" variable="title"/>
      </else-if>
      <else>
        <text form="short" variable="title"/>
      </else>
    </choose>
  </macro>
  <macro name="us-title-short-format-select">
    <choose>
      <if type="bill gazette legislation">
        <choose>
          <if variable="hereinafter">
            <text form="short" variable="hereinafter"/>
          </if>
          <else>
            <text form="short" variable="title"/>
          </else>
        </choose>
      </if>
      <else-if type="legal_case">
        <choose>
          <if variable="hereinafter">
            <text font-style="italic" form="short" variable="hereinafter"/>
          </if>
          <else-if disambiguate="true">
            <text font-style="italic" form="short" variable="title"/>
          </else-if>
          <else-if jurisdiction="us">
            <choose>
              <if variable="collection-number" type="legal_case" match="any">
                <text font-style="italic" form="short" variable="title-short"/>
              </if>
              <else-if match="none" variable="container-title">
                <text font-style="italic" form="short" variable="title-short"/>
              </else-if>
            </choose>
          </else-if>
          <else>
            <text font-style="italic" form="short" variable="title-short"/>
          </else>
        </choose>
      </else-if>
      <else-if variable="hereinafter">
        <text variable="hereinafter"/>
      </else-if>
      <else>
        <text macro="us-default-title"/>
      </else>
    </choose>
  </macro>
  <macro name="us-edition">
    <group delimiter=" ">
      <number form="ordinal" variable="edition"/>
      <text form="short" term="edition"/>
    </group>
  </macro>
  
  <macro name="us-issued">
    <group delimiter=" ">
      <choose>
        <if type="classic"/>
        <else-if type="manuscript">
          <group delimiter=", ">
            <text macro="us-issued-content"/>
          </group>
        </else-if>
        <else>
          <group delimiter=", " prefix="(" suffix=")">
            <text macro="us-issued-content"/>
          </group>
        </else>
      </choose>
      <!-- date date-parts="year-month-day" form="text" prefix="(" suffix=")" variable="issued"/ -->
    </group>
  </macro>
  <macro name="us-issued-content">
    <group delimiter=", ">
      <choose>
        <if type="graphic song broadcast">
          <text variable="medium"/>
        </if>
      </choose>
      <choose>
        <if type="graphic">
          <text variable="dimensions"/>
        </if>
        <else-if type="song broadcast video">
          <text variable="genre"/>
        </else-if>
      </choose>
      <text macro="us-editor"/>
      <choose>
        <if type="song"/>
        <else-if variable="collection-title">
          <text variable="collection-title"/>
          <group delimiter=" ">
            <choose>
              <if is-numeric="collection-number">
                <label form="long" variable="volume"/>
              </if>
            </choose>
            <number label-form="short" variable="collection-number"/>
          </group>
        </else-if>
      </choose>
      <choose>
        <if type="manuscript">
          <group delimiter=" ">
            <text term="in"/>
            <text form="short" variable="archive"/>
          </group>
        </if>
        <else>
          <group delimiter=" ">
            <text font-style="italic" term="in"/>
            <text form="short" variable="archive"/>
          </group>
        </else>
      </choose>
      <text variable="archive_location"/>
      <group delimiter=" ">
        <group delimiter=" ">
          <group delimiter=", ">
            <choose>
              <if match="none" type="thesis">
                <group delimiter=", " subgroup-delimiter="; ">
                  <choose>
                    <if type="chapter book manuscript" match="none">
                      <text variable="publisher-place"/>
                    </if>
                  </choose>
                  <names variable="authority">
                    <name/>
                    <institution institution-parts="short" reverse-order="true"/>
                  </names>
                  <choose>
                    <if type="chapter book manuscript" match="none">
                      <text form="short" variable="publisher"/>
                    </if>
                  </choose>
                </group>
                <text macro="us-edition"/>
              </if>
            </choose>
            <choose>
              <if variable="locator-extra">
                <text variable="locator-extra"/>
                <text macro="us-issued-date"/>
              </if>
            </choose>
          </group>
        </group>
        <choose>
          <if match="none" variable="locator-extra">
            <text macro="us-issued-date"/>
          </if>
        </choose>
      </group>
    </group>
  </macro>
  <macro name="us-issued-date">
    <choose>
      <if type="post-weblog post webpage graphic paper-conference article-newspaper article-magazine interview personal_communication thesis broadcast video">
        <date date-parts="year-month-day" form="text" variable="issued"/>
      </if>
      <else>
        <choose>
          <if variable="version">
            <date date-parts="year-month-day" form="text" variable="issued"/>
          </if>
          <else-if match="all" type="song" variable="collection-title">
            <choose>
              <if match="none" variable="container-title">
                <date date-parts="year-month-day" form="text" variable="issued"/>
              </if>
              <else>
                <date date-parts="year" form="text" variable="issued"/>
              </else>
            </choose>
          </else-if>
          <else>
            <choose>
              <if variable="locator-date">
                <date date-parts="year-month-day" form="text" variable="locator-date"/>
              </if>
              <else>
                <date date-parts="year" form="text" variable="issued"/>
              </else>
            </choose>
          </else>
        </choose>
      </else>
    </choose>
  </macro>
  <macro name="ibid-with-locator-label">
    <group delimiter=" ">
      <text font-style="italic" term="ibid"/>
      <text label-form="short" macro="std-locator-non-page-label-at"/>
    </group>
  </macro>

  <macro name="std-locator-non-page-label">
    <group delimiter=" ">
      <choose>
        <if locator="page" match="none">
          <label form="symbol" variable="locator"/>
        </if>
      </choose>
      <number variable="locator"/>
    </group>
  </macro>
  <macro name="us-pinpoint-action">
    <group delimiter=" ">
      <choose>
        <if locator="page" match="none" type="personal_communication">
          <text label-form="symbol" macro="std-locator-non-page-label"/>
        </if>
        <else-if position="ibid-with-locator">
          <text label-form="symbol" macro="std-locator-non-page-label-at"/>
        </else-if>
        <else-if is-numeric="title" match="all" type="book" variable="title">
          <text label-form="symbol" macro="std-locator-non-page-label-at"/>
        </else-if>
        <else-if match="all" type="song" variable="section">
          <text label-form="symbol" macro="std-locator-non-page-label-at"/>
        </else-if>
        <else-if is-numeric="title" match="all" type="song" variable="title locator">
          <text label-form="symbol" macro="std-locator-non-page-label-at"/>
        </else-if>
        <else-if type="personal_communication">
          <text macro="std-locator-non-page-label-at"/>
        </else-if>
        <else-if type="legal_case" position="subsequent" match="all">
          <text macro="std-locator-non-page-label"/>
        </else-if>
        <else>
          <number variable="locator"/>
        </else>
      </choose>
    </group>
  </macro>
  
  <macro name="us-report-first">
    <text value="[us-report-first]"/>
  </macro>

  <macro name="us-report-subsequent">
    <text value="[us-report-subsequent]"/>
  </macro>

  <macro name="us-hearing-front">
    <group delimiter="" font-style="italic">
      <text variable="title"/>
      <group delimiter=" ">
        <text value=": Hearing"/>
        <group delimiter=" ">
          <text value="on"/>
          <number variable="number"/>
        </group>
        <group delimiter=" ">
          <text value="Before the"/>
          <names variable="authority">
            <name delimiter=" of the "/>
            <institution stop-last="1" institution-parts="short"/>
          </names>
        </group>
      </group>
    </group>
  </macro>

  <macro name="us-hearing-subsequent">
    <text value="[us-hearing-subsequent]"/>
  </macro>

  <macro name="us-slip-opinion-locator">
    <group delimiter=", ">
      <group delimiter=" ">
        <text value="No."/>
        <number text-case="normal" variable="number"/>
      </group>
      <group delimiter=" ">
        <text variable="archive"/>
        <text variable="archive_location"/>
      </group>
      <group delimiter=" ">
        <choose>
          <if variable="archive"/>
          <else>
            <text value="slip op."/>
          </else>
        </choose>
        <text label-form="symbol" macro="std-locator-non-page-label-at"/>
      </group>
    </group>
  </macro>
  <macro name="us-case-first">
    <choose>
      <if variable="title">
        <group delimiter=", ">
          <text form="short" variable="title"/>
          <group delimiter=" ">
            <choose>
              <if variable="volume">
                <number variable="volume"/>
              </if>
              <else-if match="none" variable="container-title collection-number">
                <text macro="us-slip-opinion-locator"/>
              </else-if>
            </choose>
            <group delimiter=", ">
              <group delimiter=" ">
                <group delimiter=" " prefix="[" suffix="]">
                  <number variable="collection-number"/>
                  <text form="short" variable="genre"/>
                </group>
                <text form="short" variable="container-title"/>
              </group>
              <group delimiter=", ">
                <choose>
                  <if type="article-newspaper">
                    <date date-parts="year-month-day" form="text" variable="issued"/>
                    <choose>
                      <if match="all" variable="issued page">
                        <text term="at"/>
                      </if>
                    </choose>
                  </if>
                </choose>
              </group>
            </group>
            <group delimiter=" ">
              <group delimiter=", ">
                <group delimiter=" ">
                  <choose>
                    <if match="none" page="page">
                      <label form="symbol" variable="page"/>
                    </if>
                  </choose>
                  <number variable="page"/>
                </group>
                <choose>
                  <if variable="page">
                    <text macro="us-pinpoint-action"/>
                  </if>
                </choose>
              </group>
              <text macro="us-pinpoint-action"/>
            </group>
            <group delimiter=" " prefix="(" suffix=")">
              <text macro="std-authority-full"/>
              <choose>
                <if variable="volume">
                  <date date-parts="year" form="text" variable="issued"/>
                </if>
                <else>
                  <date date-parts="year-month-day" form="text" variable="issued"/>
                </else>
              </choose>
            </group>
            <group delimiter=" " prefix="[" suffix="]"> 
              <choose>
                <if variable="hereinafter">
                  <choose>
                    <if position="first" match="all">
                      <text value="hereinafter"/>
                    </if>
                    <else>
                      <text value="hereinbefore"/>
                    </else>
                  </choose>
                  <text font-style="italic" form="short" variable="hereinafter"/>
                </if>
              </choose>
            </group>
          </group>
        </group>
      </if>
      <else>
        <group delimiter=", ">
          <text macro="std-authority-key"/>
          <text form="short" variable="title"/>
          <date form="text" variable="issued"/>
          <text font-style="italic" variable="container-title"/>
          <number variable="volume"/>
          <group delimiter=" ">
            <text variable="section"/>
            <label form="short" variable="page"/>
            <number variable="page"/>
          </group>
          <number variable="number"/>
          <group delimiter=" ">
            <text variable="genre"/>
            <text font-variant="small-caps" macro="us-author"/>
          </group>
        </group>
      </else>
    </choose>
  </macro>
  <macro name="us-case-subsequent">
    <group delimiter=", ">
      <text macro="us-title-short"/>
      <group delimiter=" ">
        <group delimiter=", ">
          <choose>
            <if match="any" variable="volume container-title">
              <number variable="volume"/>
            </if>
            <else>
              <choose>
                <if match="none" position="near-note">
                  <group delimiter=" ">
                    <text value="No."/>
                    <number text-case="normal" variable="number"/>
                  </group>
                </if>
              </choose>
              <group delimiter=" ">
                <text variable="archive"/>
                <text variable="archive_location"/>
              </group>
              <text label-form="symbol" macro="std-locator-non-page-label-at"/>
            </else>
          </choose>
        </group>
        <group prefix="[" suffix="]">
          <number variable="collection-number"/>
        </group>
        <group delimiter=", ">
          <text form="short" variable="container-title"/>
          <choose>
            <if type="article-newspaper">
              <date date-parts="year-month-day" form="text" variable="issued"/>
              <choose>
                <if match="all" variable="issued page">
                  <text term="at"/>
                </if>
              </choose>
            </if>
          </choose>
        </group>
        <choose>
          <if variable="locator">
            <text macro="us-pinpoint-action"/>
          </if>
          <else>
            <group delimiter=" ">
              <choose>
                <if match="none" page="page">
                  <label form="symbol" variable="page"/>
                </if>
              </choose>
              <number variable="page"/>
            </group>
          </else>
        </choose>
      </group>
    </group>
  </macro>
  <macro name="us-legislation-subsequent">
    <choose>
      <if match="any" variable="title container-title">
        <group delimiter=", ">
          <text variable="title"/>
          <group delimiter=" ">
            <group delimiter=" " is-parallel="true">
              <text macro="us-code-detail"/>
            </group>
            <text label-form="symbol" macro="std-locator-non-page-label"/>
          </group>
        </group>
      </if>
      <else>
        <text macro="us-legislation-first"/>
      </else>
    </choose>
  </macro>
  <macro name="us-legislation-first">
    <group delimiter=" ">
      <group delimiter=", ">
        <text form="short" variable="title"/>
        <choose>
          <if type="gazette">
            <group delimiter=" ">
              <choose>
                <if is-numeric="number">
                  <text value="Pub. L. No."/>
                </if>
              </choose>
              <number label-form="short" variable="number"/>
            </group>
          </if>
        </choose>
        <group delimiter=" ">
          <text macro="us-code-detail"/>
          <number variable="page"/>
          <choose>
            <if locator="page" match="none">
              <text label-form="symbol" macro="std-locator-non-page-label"/>
            </if>
          </choose>
        </group>
        <text label-form="symbol" macro="std-locator-non-page-label"/>
        <choose>
          <if variable="number">
            <text label-form="symbol" macro="std-locator-non-page-label"/>
          </if>
          <else-if locator="page" match="all" variable="page">
            <text label-form="symbol" macro="std-locator-non-page-label"/>
          </else-if>
          <else-if variable="container-title"/>
          <else-if locator="section paragraph"/>
          <else-if match="none" variable="container-title">
            <text label-form="symbol" macro="std-locator-non-page-label"/>
          </else-if>
        </choose>
      </group>
      <text label-form="symbol" macro="std-locator-non-page-label"/>
      <group delimiter=" " prefix="(" suffix=")">
        <text form="short" variable="publisher"/>
        <choose>
          <if variable="publication-date">
            <date date-parts="year" form="text" variable="publication-date"/>
          </if>
          <else>
            <date date-parts="year" form="text" variable="issued"/>
          </else>
        </choose>
      </group>
    </group>
  </macro>
  <macro name="us-code-detail">
    <group delimiter=" ">
      <number variable="volume"/>
      <choose>
        <if type="legislation">
          <text font-variant="small-caps" form="short" variable="container-title"/>
          <number label-form="short" variable="number"/>
        </if>
        <else>
          <text form="short" variable="container-title"/>
        </else>
      </choose>
     </group>
  </macro>
  <macro name="us-bill-first">
    <group delimiter=" ">
      <group delimiter=", ">
        <text macro="us-bill-front"/>
        <text macro="us-bill-middle"/>
      </group>
      <text label-form="symbol" macro="std-locator-non-page-label"/>
      <text macro="us-bill-end"/>
    </group>
  </macro>
  <macro name="us-bill-front">
    <choose>
      <if variable="title">
        <choose>
          <if type="hearing">
            <text macro="us-hearing-front"/>
          </if>
          <else>
            <text variable="title"/>
          </else>
        </choose>
      </if>
      <else>
        <text macro="us-bill-name-stub"/>
      </else>
    </choose>
  </macro>
  <macro name="us-bill-middle">
    <group delimiter=", ">
      <choose>
        <if variable="title">
          <text macro="us-bill-name-stub"/>
        </if>
      </choose>
      <group delimiter=" ">
        <number form="ordinal" variable="collection-number"/>
        <text macro="std-authority-parent"/>
      </group>
      <choose>
        <if subjurisdictions="1">
          <text macro="us-session-number"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="us-bill-end">
    <group delimiter=" " prefix="(" suffix=")">
      <choose>
        <if match="none" subjurisdictions="1">
          <text macro="us-session-number"/>
        </if>
        <else>
          <text form="short" variable="jurisdiction"/>
        </else>
      </choose>
      <date date-parts="year" form="text" variable="issued"/>
    </group>
  </macro>
  <macro name="us-bill-name-stub">
    <group delimiter=" ">
      <choose>
        <if variable="event">
          <text form="short" variable="event"/>
        </if>
        <else-if type="hearing" match="none">
          <text macro="std-authority-child"/>
        </else-if>
      </choose>
      <choose>
        <if type="hearing" match="none">
          <number variable="number"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="us-session-number">
    <group delimiter=" ">
      <number form="ordinal" variable="chapter-number"/>
      <choose>
        <if variable="genre">
          <text form="short" variable="genre"/>
        </if>
        <else>
          <text value="Sess."/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="us-bill-subsequent">
    <group delimiter=" ">
      <group delimiter=", ">
        <text macro="us-bill-front"/>
        <choose>
          <if type="hearing">
            <text label-form="symbol" macro="wisconsin-supra-stub"/>
          </if>
        </choose>
      </group>
      <group delimiter=" ">
        <label form="symbol" variable="locator"/>
        <number label-form="symbol" variable="locator"/>
      </group>
    </group>
  </macro>
  <macro name="wisconsin-supra-stub">
    <group delimiter=", ">
      <group delimiter=" ">
        <group delimiter=" ">
          <text font-style="italic" value="supra"/>
          <choose>
            <if variable="first-reference-note-number">
              <text value="note"/>
              <text variable="first-reference-note-number"/>
            </if>
          </choose>
        </group>
        <choose>
          <if match="all" variable="first-reference-note-number locator"/>
          <else>
            <text macro="std-locator-paragraph-bracket-at"/>
          </else>
        </choose>
      </group>
      <text macro="std-locator-paragraph-bracket-at"/>
    </group>
  </macro>
  
  <macro name="ca-case-title">
    <group delimiter=" ">
      <choose>
        <if match="none" position="near-note">
          <text form="short" variable="title"/>
          <choose>
            <if match="any" variable="container-title collection-number"> 
              <date date-parts="year" form="text" prefix="(" suffix=")" variable="issued"/>
            </if>
            <else>
              <date date-parts="year-month-day" form="text" prefix="(" suffix=")" variable="issued"/>
            </else>
          </choose>
        </if>
        <else>
          <text font-style="italic" form="short" variable="title"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="ca-case-unreported-detail">
    <group delimiter=" ">
      <text variable="publisher-place"/>
      <number variable="number"/>
    </group>
  </macro>
  <macro name="ca-case-nominate-yearvol-detail">
    <group delimiter=" ">
      <number prefix="[" suffix="]" variable="collection-number"/>
      <number variable="volume"/>
      <text form="short" variable="container-title"/>
    </group>
  </macro>
  <macro name="ca-case-nominate-vol-detail">
    <group delimiter=" ">
      <number variable="volume"/>
      <text form="short" variable="container-title"/>
    </group>
  </macro>
  <macro name="ca-case-nominate">
    <choose>
      <if variable="collection-number">
        <text macro="ca-case-nominate-yearvol-detail"/>
      </if>
      <else>
        <text macro="ca-case-nominate-vol-detail"/>
      </else>
    </choose>
  </macro>
  <macro name="ca-case-neutral-detail">
    <group delimiter=" ">
      <number variable="collection-number"/>
      <text macro="std-authority-key"/>
    </group>
  </macro>
  <macro name="ca-case-detail">
    <group delimiter=" ">
      <text macro="ca-case-detail-stub"/>
      <number variable="page-first"/>
    </group>
  </macro>
  <macro name="ca-case-detail-stub">
    <choose>
      <if match="none" variable="container-title">
        <choose>
          <if variable="collection-number">
            <text macro="ca-case-neutral-detail"/>
          </if>
          <else>
            <text macro="ca-case-unreported-detail"/>
          </else>
        </choose>
      </if>
      <else>
        <text macro="ca-case-nominate"/>
      </else>
    </choose>
  </macro>
  <macro name="jurisdictions-case">
    <choose>
      <if jurisdiction="us">
        <choose>
          <if position="near-note">
            <text macro="us-case-subsequent"/>
          </if>
          <else>
            <text macro="us-case-first"/>
          </else>
        </choose>
      </if>
      <else-if jurisdiction="coe.int">
        <choose>
          <if position="near-note">
            <text label-form="short" macro="coe-case-first"/>
          </if>
          <else>
            <text label-form="short" macro="coe-case-first"/>
          </else>
        </choose>
      </else-if>
      <else-if jurisdiction="ca">
        <choose>
          <if position="near-note">
            <group delimiter=", ">
              <text macro="ca-case-title"/>
              <group delimiter=" ">
                <text macro="ca-case-detail-stub"/>
                <choose>
                  <if match="any" variable="container-title collection-number">
                    <choose>
                      <if locator="page" match="all" variable="locator page-first">
                        <number variable="locator"/>
                      </if>
                      <else-if variable="page-first">
                        <number variable="page-first"/>
                      </else-if>
                    </choose>
                  </if>
                </choose>
              </group>
              <choose>
                <if match="none" variable="container-title collection-number">
                  <text label-form="short" macro="std-locator-non-page-label-at"/>
                </if>
                <else>
                  <text label-form="short" macro="std-locator-non-page-label"/>
                </else>
              </choose>
            </group>
          </if>
          <else>
            <group delimiter=" ">
              <group delimiter=", ">
                <group delimiter=" ">
                  <text macro="ca-case-first"/>
                </group>
                <choose>
                  <if match="none" variable="container-title collection-number">
                    <text label-form="short" macro="std-locator-non-page-label-at"/>
                  </if>
                  <else>
                    <text label-form="short" macro="std-locator-non-page-label"/>
                  </else>
                </choose>
              </group>
              <text macro="std-authority-full" prefix="(" suffix=")"/>
            </group>
          </else>
        </choose>
      </else-if>
      <else>
        <choose>
          <if position="near-note">
            <text macro="gb-case-subsequent"/>
          </if>
          <else>
            <text macro="gb-case-first"/>
          </else>
        </choose>        
      </else>
    </choose>
  </macro>
  <macro name="std-authority-parent">
    <names variable="authority">
      <name/>
      <institution institution-parts="short" use-last="1"/>
    </names>
  </macro>
  <macro name="un-resolution-first">
    <group delimiter=", ">
      <text form="short" variable="title"/>
      <group delimiter=" ">
        <text macro="std-authority-parent"/>
        <text form="short" variable="event"/>
        <number variable="number"/>
      </group>
      <text form="short" variable="container-title"/>
      <choose>
        <if is-numeric="collection-number">
          <number form="ordinal" variable="collection-number"/>
          <text value="Sess."/>
        </if>
        <else>
          <number variable="collection-number"/>
        </else>
      </choose>
      <group delimiter=" ">
        <text value="Supp. No."/>
        <number variable="chapter-number"/>
      </group>
      <group delimiter=" ">
        <group delimiter=", ">
          <group delimiter=" ">
            <text value="U.N. Doc."/>
            <text variable="archive_location"/>
          </group>
          <text macro="std-locator-non-page-label-at"/>
        </group>
        <date date-parts="year-month-day" form="text" prefix="(" suffix=")" variable="issued"/>
      </group>
    </group>
  </macro>
  <macro name="un-resolution-subsequent">
    <group delimiter=", ">
      <group delimiter=" ">
        <text macro="std-authority-parent"/>
        <text variable="event"/>
        <number variable="number"/>
      </group>
      <group delimiter=" ">
        <text font-style="italic" value="supra"/>
        <text value="note"/>
        <text variable="first-reference-note-number"/>
      </group>
      <text macro="std-locator-non-page-label-at"/>
    </group>
  </macro>
  <macro name="jurisdictions-bill">
    <choose>
      <if jurisdiction="gb ca nz">
        <choose>
          <if position="near-note">
            <text macro="gb-bill-first"/>
          </if>
          <else>
            <text macro="gb-bill-first"/>
          </else>
        </choose>
      </if>
      <else-if jurisdiction="un.org">
        <choose>
          <if position="subsequent">
            <text macro="un-resolution-subsequent"/>
          </if>
          <else>
            <text macro="un-resolution-first"/>
          </else>
        </choose>
      </else-if>
      <else>
        <choose>
          <if position="near-note">
            <text macro="us-bill-subsequent"/>
          </if>
          <else>
            <text macro="us-bill-first"/>
          </else>
        </choose>
      </else>
    </choose>
  </macro>

  <macro name="gb-bill-first">
    <text value="[gb-bill-first]"/>
  </macro>
  <macro name="ca-case-first">
    <group delimiter=", ">
      <text macro="ca-case-title"/>
      <text macro="ca-case-detail"/>
    </group>
  </macro>
  <macro name="amlaw-nz-legislation-subsequent">
    <group delimiter=", ">
      <group delimiter=" ">
        <text form="short" variable="title"/>
        <date date-parts="year" form="text" variable="issued"/>
      </group>
      <text label-form="symbol" macro="std-locator-label"/>
    </group>
  </macro>
  <macro name="jurisdictions-legislation">
    <choose>
      <if jurisdiction="nz gb" match="any">
        <choose>
          <if position="near-note">
            <text macro="amlaw-nz-legislation-subsequent"/>
          </if>
          <else>
            <text macro="nz-legislation-first"/>
          </else>
        </choose>
      </if>
      <else>
        <choose>
          <if position="near-note">
            <text macro="us-legislation-subsequent"/>
          </if>
          <else>
            <text macro="us-legislation-first"/>
          </else>
        </choose>
      </else>
    </choose>
  </macro>

  <macro name="jurisdictions-hearing">
    <choose>
      <if jurisdiction="us ca nz">
        <choose>
          <if position="near-note">
            <text macro="us-bill-subsequent"/>
          </if>
          <else>
            <text macro="us-bill-first"/>
          </else>
        </choose>
      </if>
      <else-if jurisdiction="gb">
        <choose>
          <if position="near-note">
            <text macro="gb-hearing-subsequent"/>
          </if>
          <else>
            <text macro="gb-hearing-first"/>
          </else>
        </choose>
      </else-if>
      <else>
        <choose>
          <if position="near-note">
            <text macro="gb-bill-subsequent"/>
          </if>
          <else>
            <text macro="gb-bill-first"/>
          </else>
        </choose>
      </else>
    </choose>
  </macro>
  <macro name="gb-bill-subsequent">
    <text value="[gb-bill-subsequent]"/>
  </macro>
  <macro name="jurisdictions-report">
    <choose>
      <if jurisdiction="us ca nz">
        <choose>
          <if position="near-note">
            <text macro="us-report-subsequent"/>
          </if>
          <else>
            <text macro="us-report-first"/>
          </else>
        </choose>
      </if>
      <else-if jurisdiction="gb">
        <choose>
          <if position="near-note">
            <text macro="gb-report-subsequent"/>
          </if>
          <else>
            <text macro="gb-report-first"/>
          </else>
        </choose>
      </else-if>
      <else-if jurisdiction="europa.eu">
        <choose>
          <if position="near-note">
            <text macro="eu-report-subsequent"/>
          </if>
          <else>
            <text macro="eu-report-first"/>
          </else>
        </choose>
      </else-if>
    </choose>
  </macro>

  <macro name="jurisdictions-patent">
    <choose>
      <if jurisdiction="us">
        <choose>
          <if position="near-note">
            <group delimiter=", ">
              <text macro="std-patent-detail"/>
              <group delimiter=" ">
                <text term="at"/>
                <text macro="std-locator-paragraph-bracket"/>
              </group>
            </group>
          </if>
          <else>
            <group delimiter=" ">
              <text macro="std-patent-first"/>
              <text macro="std-locator-paragraph-bracket"/>
            </group>
          </else>
        </choose>
      </if>
      <else>
        <choose>
          <if position="near-note">
            <group delimiter=", ">
              <text macro="std-patent-detail"/>
              <group delimiter=" ">
                <text term="at"/>
                <text macro="std-locator-paragraph-bracket"/>
              </group>
            </group>
          </if>
          <else>
            <group delimiter=", ">
              <text macro="std-patent-first"/>
              <group delimiter=" ">
                <text term="at"/>
                <text macro="std-locator-paragraph-bracket"/>
              </group>
            </group>
          </else>
        </choose>
      </else>
    </choose>
  </macro>
  <macro name="eu-report-first">
    <group delimiter=", ">
      <group delimiter=" ">
        <text macro="eu-report-detail"/>
        <text prefix="(" suffix=")" variable="genre"/>
        <text value="COM"/>
        <number variable="number"/>
      </group>
      <text macro="std-locator-non-page-label"/>
    </group>
  </macro>

  <macro name="eu-report-detail">
    <group delimiter=", ">
      <names variable="author">
        <name/>
        <institution institution-parts="short"/>
      </names>
      <text form="short" quotes="true" text-case="title" variable="title"/>
    </group>
  </macro>

  <macro name="eu-report-subsequent">
    <group delimiter=", ">
      <text macro="eu-report-detail"/>
      <text macro="wisconsin-supra-stub"/>
    </group>
  </macro>
  <macro name="std-patent-first">
    <group delimiter=", ">
      <group delimiter="; ">
        <group delimiter=" ">
          <names variable="author">
            <name/>
          </names>
          <text macro="std-inventor-label" prefix="(" suffix=")"/>
        </group>
        <group delimiter=" ">
          <names variable="recipient">
            <name/>
          </names>
          <text macro="std-assignee-label" prefix="(" suffix=")"/>
        </group>
      </group>
      <group delimiter=", ">
        <text macro="std-patent-detail"/>
        <group delimiter=", " prefix="(" suffix=")">
          <group delimiter=" ">
            <text value="filed"/>
            <date form="text" variable="submitted"/>
          </group>
          <group delimiter=" ">
            <text value="issued"/>
            <date form="text" variable="issued"/>
          </group>
        </group>
      </group>
    </group>
  </macro>
  <macro name="oscola-pinpoint-case">
    <choose>
      <if locator="paragraph" match="all" type="legal_case">
        <number prefix="[" suffix="]" variable="locator"/>
      </if>
      <else>
        <group delimiter=" ">
          <label form="short" variable="locator"/>
          <number variable="locator"/>
        </group>
      </else>
    </choose>
  </macro>
  <macro name="oscola-court-hint">
    <choose>
      <if match="none" position="near-note">
        <choose>
          <if variable="container-title">
            <text macro="std-authority-child" prefix="(" strip-periods="true" suffix=")"/>
          </if>
          <else-if variable="collection-number">
            <text macro="std-authority-child-shy" prefix="(" strip-periods="true" suffix=")"/>
          </else-if>
        </choose>
      </if>
    </choose>
  </macro>
  <macro name="oscola-case-hinted-page">
    <choose>
      <if locator="page">
        <group delimiter=", ">
          <group delimiter=" ">
            <number variable="page"/>
            <!-- group oops=", ">
              <text macro="oscola-court-hint"/>
            </group -->
            <choose>
              <if variable="authority">
                <number variable="locator"/>
              </if>
            </choose>
          </group>
          <number variable="locator"/>
        </group>
      </if>
      <else>
        <group delimiter=" ">
          <number variable="page"/>
          <group delimiter=" ">
            <text macro="oscola-court-hint"/>
            <text macro="oscola-pinpoint-case"/>
          </group>
        </group>
      </else>
    </choose>
  </macro>
  <macro name="coe-case-first">
    <group delimiter=" ">
      <group delimiter=", ">
        <choose>
          <if match="none" position="near-note">
            <text variable="title"/>
          </if>
          <else>
            <text font-style="italic" variable="title"/>
          </else>
        </choose>
        <text macro="coe-case-detail"/>
        <choose>
          <if locator="page">
            <number variable="locator"/>
          </if>
        </choose>
      </group>
      <text macro="std-locator-paragraph-bracket"/>
    </group>
  </macro>

  <macro name="coe-case-detail">
    <choose>
      <if variable="container-title">
        <choose>
          <if match="all" variable="volume collection-number">
            <choose>
              <if is-numeric="volume" match="none">
                <group delimiter=" ">
                  <group delimiter="-">
                    <number variable="collection-number"/>
                    <number variable="volume"/>
                  </group>
                  <text macro="std-authority-key"/>
                  <number variable="page"/>
                </group>
              </if>
              <else>
                <text macro="coe-case-detail-ordinary"/>
              </else>
            </choose>
          </if>
          <else>
            <text macro="coe-case-detail-ordinary"/>
          </else>
        </choose>
      </if>
      <else>
        <choose>
          <if match="none" position="near-note">
            <group delimiter=" ">
              <group delimiter=" ">
                <text value="App. No."/>
                <number variable="number"/>
              </group>
              <group delimiter=", " prefix="(" suffix=")">
                <text macro="std-authority-parent"/>
                <date date-parts="year-month-day" form="text" variable="issued"/>
              </group>
            </group>
          </if>
        </choose>
      </else>
    </choose>
  </macro>
  <macro name="coe-case-detail-ordinary">
    <group delimiter=", ">
      <choose>
        <if match="none" position="near-note" variable="collection-number">
          <group delimiter=" ">
            <text value="App. No."/>
            <number variable="number"/>
          </group>
        </if>
      </choose>
      <group delimiter=" ">
        <number variable="volume"/>
        <text form="short" variable="container-title"/>
        <group delimiter=", ">
          <group delimiter=" ">
            <choose>
              <if match="none" position="near-note">
                <number variable="page"/>
              </if>
              <else-if match="none" variable="locator">
                <number variable="page"/>
              </else-if>
            </choose>
            <choose>
              <if locator="page" match="all" variable="page"/>
              <else>
                <text label-form="short" macro="std-locator-paragraph-bracket-at"/>
              </else>
            </choose>
          </group>
          <number variable="locator"/>
        </group>
        <choose>
          <if match="none" position="near-note">
            <choose>
              <if variable="publication-date">
                <date date-parts="year" form="text" prefix="(" suffix=")" variable="publication-date"/>
              </if>
              <else>
                <date date-parts="year" form="text" prefix="(" suffix=")" variable="issued"/>
              </else>
            </choose>
          </if>
        </choose>
      </group>
    </group>
  </macro>

  <macro name="us-default-chapter-to-book">
    <choose>
      <if type="chapter">
        <text font-style="italic" term="in"/>
      </if>
    </choose>
  </macro>
  <macro name="us-container-title">
    <group delimiter=" ">
      <choose>
        <if match="all" type="song" variable="title container-title">
          <text font-style="italic" value="on"/>
        </if>
      </choose>
      <choose>
        <if type="broadcast"/>
        <else-if match="all" type="video" variable="publisher"/>
        <else>
          <text font-variant="small-caps" form="short" variable="container-title"/>
        </else>

      </choose>
    </group>
  </macro>
  <macro name="us-default-presentation-description">
    <choose>
      <if match="all" type="paper-conference" variable="container-title event"/>
      <else-if variable="event">
        <group delimiter=" ">
          <group delimiter=" ">
            <choose>
              <if variable="title">
                <text value="presented at"/>
              </if>
              <else-if variable="genre">
                <text form="short" variable="genre"/>
              </else-if>
              <else>
                <text value="Presentation at"/>
              </else>
            </choose>
          </group>
          <text text-case="title" variable="event"/>
        </group>
      </else-if>
    </choose>
  </macro>
  <macro name="us-default-thesis-details">
    <choose>
      <if type="thesis">
        <group delimiter=", " prefix="(" suffix=")">
          <group delimiter=" ">
            <text value="unpublished"/>
            <text variable="genre"/>
          </group>
          <text variable="publisher"/>
        </group>
      </if>
    </choose>
  </macro>
  <macro name="opus-number">
    <choose>
      <if type="song">
        <text text-case="capitalize-first" variable="section"/>
      </if>
    </choose>
  </macro>
  <macro name="std-locator-non-page-label-at">
    <group delimiter=" ">
      <choose>
        <if locator="page">
          <text term="at"/>
        </if>
        <else>
          <label form="short" variable="locator"/>
        </else>
      </choose>
      <number variable="locator"/>
    </group>
  </macro>
  <macro name="jurisdiction-filter">
    <choose>
      <if match="all" position="ibid-with-locator">
        <group delimiter=" ">
          <group>
            <text font-style="italic" term="ibid"/>
          </group>
          <choose>
            <if jurisdiction="ca" match="all" type="legal_case">
              <group delimiter=", ">
                <text label-form="short" macro="std-locator-non-page-label-at"/>
              </group>
            </if>
            <else-if type="legal_case">
              <choose>
                <if jurisdiction="us">
                  <group delimiter=" ">
                    <text label-form="symbol" macro="std-locator-non-page-label-at"/>
                  </group>
                </if>
                <else>
                  <text label-form="short" macro="std-locator-paragraph-bracket-at"/>
                </else>
              </choose>
            </else-if>
            <else-if type="patent">
              <text label-form="short" macro="std-locator-paragraph-bracket-at"/>
            </else-if>
            <else-if match="any" type="bill gazette legislation">
              <text label-form="symbol" macro="std-locator-non-page-label-at"/>
            </else-if>
            <else>
              <text label-form="short" macro="std-locator-non-page-label-at"/>
            </else>
          </choose>
        </group>
      </if>
      <else-if position="ibid">
        <text font-style="italic" term="ibid"/>
      </else-if>
      <else-if type="article-newspaper">
        <choose>
          <if position="subsequent">
            <text macro="wisconsin-secondary-subsequent"/>
          </if>
          <else>
            <text macro="wisconsin-secondary-first"/>
          </else>
        </choose>
      </else-if>
      <else-if type="legal_case">
        <text macro="jurisdictions-case"/>
      </else-if>
      <else-if type="bill">
        <text macro="jurisdictions-bill"/>
      </else-if>
      <else-if match="any" type="gazette legislation">
        <text macro="jurisdictions-legislation"/>
      </else-if>
      <else-if type="hearing">
        <text macro="jurisdictions-hearing"/>
      </else-if>
      <else-if type="report">
        <text macro="jurisdictions-report"/>
      </else-if>
      <else-if type="treaty">
        <text macro="jurisdictions-treaty"/>
      </else-if>
      <else-if type="patent">
        <text macro="jurisdictions-patent"/>
      </else-if>
      <else-if position="subsequent">
        <text macro="wisconsin-secondary-subsequent"/>
      </else-if>
      <else>
        <text macro="wisconsin-secondary-first"/>
      </else>
    </choose>
  </macro>
  <macro name="jurisdictions-treaty">
    <choose>
      <if position="subsequent">
        <text macro="wisconsin-treaty-subsequent"/>
      </if>
      <else>
        <text macro="wisconsin-treaty-first"/>
      </else>
    </choose>
  </macro>
  <macro name="wisconsin-treaty-first">
    <group delimiter=", ">
      <text form="short" variable="title"/>
      <names variable="author">
        <name/>
        <institution delimiter="-" institution-parts="short"/>
      </names>
      <text label-form="short" macro="std-locator-non-page-label"/>
      <date date-parts="year-month-day" form="text" variable="original-date"/>
      <group delimiter=" ">
        <number variable="volume"/>
        <text form="short" variable="container-title"/>
        <number variable="page-first"/>
      </group>
    </group>
  </macro>
  <macro name="wisconsin-treaty-subsequent">
    <group delimiter=", ">
      <text form="short" variable="title"/>
      <choose>
        <if disambiguate="true">
          <names variable="author">
            <name/>
            <institution and="none" delimiter="&#8211;" institution-parts="short"/>
          </names>
        </if>
      </choose>
      <group delimiter=" ">
        <label form="short" variable="locator"/>
        <number label-form="short" variable="locator"/>
      </group>
      <group delimiter=" ">
        <text font-style="italic" value="supra"/>
        <text value="note"/>
        <text variable="first-reference-note-number"/>
      </group>
      <group delimiter=" " is-parallel="true">
        <number variable="volume"/>
        <text variable="container-title"/>
        <number variable="page-first"/>
      </group>
      <group delimiter=" " is-parallel="false">
        <text value="at"/>
        <number variable="page-first"/>
      </group>
    </group>
  </macro>
  <macro name="wisconsin-secondary-subsequent">
      <group delimiter=", ">
        <group delimiter=" ">
          <group delimiter=", ">
            <text macro="us-author-short"/>
            <text macro="us-title-short"/>
            <text font-style="italic" value="supra"/>
          </group>
          <group delimiter=" ">
            <text term="note"/>
            <text variable="first-reference-note-number"/>
          </group>
        </group>
        <group delimiter=" ">
          <choose>
            <if locator="page">
              <text term="at"/>
            </if>
            <else>
              <label form="short" variable="locator"/>
            </else>
          </choose>
          <number variable="locator"/>
        </group>
      </group>
  </macro>

  <macro name="us-collection-title-podcast">
    <choose>
      <if type="song">
        <choose>
          <if match="none" variable="container-title">
            <text font-variant="small-caps" variable="collection-title"/>
          </if>
        </choose>
      </if>
    </choose>
  </macro>

  <macro name="wisconsin-secondary-first">
    <group delimiter=": ">
      <choose>
        <if type="video">
          <text form="short" variable="medium"/>
        </if>
      </choose>
      <group delimiter=", ">
        <group delimiter=" ">
          <choose>
            <if match="any" type="book classic">
              <number variable="volume"/>
            </if>
          </choose>
          <group delimiter=", ">
            <text macro="us-default-author"/>
            <text macro="us-default-title"/>
            <text macro="us-collection-title-podcast"/>
            <text macro="opus-number"/>
            <text macro="us-default-presentation-description"/>
            <choose>
              <if type="webpage post manuscript">
                <text form="short" variable="genre"/>
              </if>
              <else-if type="report">
                <group delimiter=" ">
                  <text variable="genre"/>
                  <number variable="number"/>
                </group>
              </else-if>
            </choose>
            <group delimiter=" ">
              <text macro="us-default-chapter-to-book"/>
              <choose>
                <if match="none" type="book classic">
                  <number variable="volume"/>
                </if>
              </choose>
              <group delimiter=", ">
                <text font-variant="small-caps" macro="us-container-author"/>
                <text macro="us-container-title"/>
              </group>
              <choose>
                <if type="entry-encyclopedia entry-dictionary">
                  <choose>
                    <if match="none" variable="author">
                      <text font-style="italic" variable="title"/>
                    </if>
                  </choose>
                </if>
              </choose>
            </group>
            <choose>
              <if match="any" type="article-newspaper article-magazine">
                <choose>
                  <if has-year-only="issued">
                    <group delimiter=" ">
                      <label form="symbol" variable="issue"/>
                      <number variable="issue"/>
                    </group>
                  </if>
                </choose>
                <date date-parts="year-month-day" form="text" variable="issued"/>
                <choose>
                  <if match="none" variable="URL">
                    <choose>
                      <if is-numeric="edition">
                        <group delimiter=" ">
                          <number form="ordinal" variable="edition"/>
                          <label form="short" variable="edition"/>
                        </group>
                      </if>
                      <else>
                        <number variable="edition"/>
                      </else>
                    </choose>
                    <group delimiter=" ">
                      <choose>
                        <if is-numeric="section">
                          <text form="symbol" term="section"/>
                        </if>
                      </choose>
                      <text variable="section"/>
                    </group>
                  </if>
                </choose>
                <group delimiter=" ">
                  <group delimiter=" ">
                    <text term="at"/>
                    <group delimiter=" ">
                      <group delimiter=", ">
                        <number variable="page-first"/>
                        <choose>
                          <if locator="page">
                            <number variable="locator"/>
                          </if>
                        </choose>
                      </group>
                      <text macro="std-locator-label"/>
                    </group>
                  </group>
                  <choose>
                    <if variable="jurisdiction">
                      <group delimiter=" " prefix="(" suffix=")">
                        <text macro="std-authority-full"/>
                        <date date-parts="year-month-day" form="text" variable="original-date"/>
                      </group>
                    </if>
                  </choose>
                </group>
              </if>
              <else-if is-numeric="title" match="all" type="book" variable="title locator">
                <text macro="us-pinpoint-action"/>
              </else-if>
              <else-if match="all" type="song" variable="section">
                <text macro="us-pinpoint-action"/>
              </else-if>
              <else-if is-numeric="title" match="all" type="song" variable="title locator">
                <text macro="us-pinpoint-action"/>
              </else-if>
              <else-if variable="volume">
                <choose>
                  <if match="none" variable="container-title">
                    <text macro="us-pinpoint-action"/>
                  </if>
                </choose>
              </else-if>
            </choose>
          </group>
          <choose>
            <if match="none" type="article-newspaper article-magazine">
              <group delimiter=", ">
                <number variable="page-first"/>
                <choose>
                  <if variable="page">
                    <text macro="us-pinpoint-action"/>
                  </if>
                </choose>
              </group>
              <choose>
                <if match="none" type="article-newspaper article-magazine">
                  <text macro="us-pinpoint-action"/>
                </if>
              </choose>
              <text macro="us-issued"/>
              <text macro="us-default-thesis-details"/>
            </if>
          </choose>
        </group>
        <choose>
          <if type="graphic post-weblog webpage post entry-dictionary entry-encyclopedia broadcast motion_picture video song map">
            <group delimiter=" ">
              <choose>
                <if type="post-weblog webpage post entry-dictionary entry-encyclopedia"/>
                <else-if match="all" type="song" variable="collection-title">
                  <choose>
                    <if variable="container-title">
                      <text font-style="italic" value="available at"/>
                    </if>
                  </choose>
                </else-if>
                <else-if variable="publisher">
                  <text font-style="italic" value="available at"/>
                </else-if>
              </choose>
              <text variable="URL"/>
            </group>
          </if>
          <else-if match="all" type="book" variable="version">
            <text variable="URL"/>
          </else-if>
          <else-if type="article-newspaper">
            <text variable="URL"/>
          </else-if>
        </choose>
      </group>
    </group>
  </macro>
  <citation disambiguate-add-givenname="true" et-al-min="3" et-al-use-first="1" near-note-distance="5">
    <layout delimiter="; " suffix=".">
      <choose>
        <if match="any" type="treaty" variable="jurisdiction">
          <text macro="jurisdiction-filter"/>
        </if>
        <else-if position="ibid-with-locator">
          <text macro="ibid-with-locator-label"/>
        </else-if>
        <else-if position="ibid">
          <text font-style="italic" term="ibid"/>
        </else-if>
        <else-if match="none" position="first" type="classic">
          <text macro="wisconsin-secondary-subsequent"/>
        </else-if>
        <else>
          <text macro="wisconsin-secondary-first"/>
        </else>
      </choose>
    </layout>
  </citation>
  <bibliography et-al-min="3" et-al-use-first="1">
    <sort>
      <key variable="author"/>
      <key variable="title"/>
      <key variable="issued"/>
    </sort>
    <layout suffix=".">
      <choose>
        <if match="any" type="treaty" variable="jurisdiction">
          <text macro="jurisdiction-filter"/>
        </if>
        <else>
          <text macro="wisconsin-secondary-first"/>
        </else>
      </choose>
    </layout>
  </bibliography>
</style>
<<===== CSL =====<<


>>===== INPUT =====>>
[
   {
      "id": "ITEM-1",
      "type": "article-magazine",
      "key": "G3A88SIZ",
      "title": "競争法における関連市場の画定基準",
      "container-title": "民商法雑誌",
      "page": "23-44",
      "volume": "126",
      "issue": "1",
      "author": [
         {
            "family": "林",
            "given": "秀弥"
         }
      ],
      "issued": {
         "date-parts": [
            [
               2002
            ]
         ]
      },
      "multi":{
			"_keys":{
				"container-title":{
					"ja-alalc97":"Minsho ho zasshi"
				}
			}
	  }
   },
   {
      "id": "ITEM-2",
      "type": "article-magazine",
      "key": "46TEXRZ7",
      "title": "競争法における関連市場の画定基準",
      "container-title": "民商法雑誌",
      "page": "56-72",
      "volume": "126",
      "issue": "2",
      "author": [
         {
            "family": "林",
            "given": "秀弥"
         }
      ],
      "issued": {
         "date-parts": [
            [
               2002
            ]
         ]
      },
      "multi":{
			"_keys":{
				"container-title":{
					"ja-alalc97":"Minsho ho zasshi"
				}
			}
	  }
   }
]
<<===== INPUT =====<<
